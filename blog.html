<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ | íƒë°©ê¸° ë° í–‰ì‚¬ ë¸”ë¡œê·¸</title>
<meta name="description" content="í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ íšŒì›ì‚¬ íƒë°©ê¸°ì™€ í–‰ì‚¬ í˜„ì¥ ê¸°ë¡ì„ ë§Œë‚˜ë³´ì„¸ìš”." />

<link rel="icon" href="https://koraia.org/default/img/symbol.ico" />
<link rel="shortcut icon" href="https://koraia.org/default/img/symbol.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/koraia-trend/koraia-trend.github.io/refs/heads/main/koraia_circle_icon_2.png" />
<link rel="icon" type="image/png" sizes="192x192" href="https://raw.githubusercontent.com/koraia-trend/koraia-trend.github.io/refs/heads/main/koraia_circle_icon_2.png" />

<meta property="og:type" content="website" />
<meta property="og:title" content="í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ | íƒë°©ê¸° ë° í–‰ì‚¬ ë¸”ë¡œê·¸" />
<meta property="og:description" content="í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ íšŒì›ì‚¬ íƒë°©ê¸°ì™€ í–‰ì‚¬ í˜„ì¥ ê¸°ë¡ì„ ë§Œë‚˜ë³´ì„¸ìš”." />
<meta property="og:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/koraia_blog.png" />
<meta property="og:url" content="https://guesskoraia.github.io/blog" />
<meta property="og:locale" content="ko_KR" />
<meta property="og:site_name" content="í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ | íƒë°©ê¸° ë° í–‰ì‚¬ ë¸”ë¡œê·¸" />
<meta name="twitter:description" content="í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ íšŒì›ì‚¬ íƒë°©ê¸°ì™€ í–‰ì‚¬ í˜„ì¥ ê¸°ë¡ì„ ë§Œë‚˜ë³´ì„¸ìš”." />
<meta name="twitter:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/koraia_blog.png" />

<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/pretendardvariable.css" />
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Pretendard Variable', Pretendard, system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans KR', Arial, sans-serif;
    background: #f8f9fa;
    color: #222;
    line-height: 1.6;
    min-height: 100vh;
  }

  /* â”€â”€ ë„¤ë¹„ê²Œì´ì…˜ â”€â”€ */
  .top-nav {
    background: #fff;
    border-bottom: 1px solid #e5e7eb;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .nav-inner {
    max-width: 1080px;
    margin: 0 auto;
    padding: 0 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 56px;
  }
  .nav-logo {
    display: flex;
    align-items: center;
    gap: 10px;
    text-decoration: none;
    color: #111;
    font-weight: 700;
    font-size: 1rem;
  }
  .nav-logo img {
    width: 32px;
    height: 32px;
    border-radius: 50%;
  }
  .nav-links {
    display: flex;
    gap: 6px;
  }
  .nav-links a {
    padding: 6px 14px;
    text-decoration: none;
    color: #555;
    font-size: 0.82rem;
    border-radius: 6px;
    transition: all 0.2s;
  }
  .nav-links a:hover { background: #f0f0f0; color: #111; }
  .nav-links a.active { background: #1a73e8; color: #fff; }

  /* â”€â”€ íˆì–´ë¡œ í—¤ë” â”€â”€ */
  .blog-hero {
    background: linear-gradient(135deg, #1a56db 0%, #1a73e8 50%, #4f94f0 100%);
    color: #fff;
    padding: 48px 20px 40px;
    text-align: center;
  }
  .blog-hero h1 {
    font-size: 1.8rem;
    font-weight: 800;
    letter-spacing: -0.03em;
    margin-bottom: 8px;
  }
  .blog-hero p {
    font-size: 0.95rem;
    opacity: 0.85;
  }

  /* â”€â”€ ì»¨í…ì¸  ë˜í¼ â”€â”€ */
  .content-wrap {
    max-width: 1080px;
    margin: 0 auto;
    padding: 24px 20px 40px;
  }

  /* â”€â”€ í•„í„° + ì •ë ¬ ë°” â”€â”€ */
  .filter-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 10px;
  }
  .type-filter {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }
  .type-filter button {
    padding: 7px 18px;
    border: 1.5px solid #ddd;
    border-radius: 20px;
    background: #fff;
    color: #555;
    font-size: 0.82rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  .type-filter button:hover {
    border-color: #1a73e8;
    color: #1a73e8;
  }
  .type-filter button.active {
    background: #1a73e8;
    color: #fff;
    border-color: #1a73e8;
  }
  .post-count {
    font-size: 0.8rem;
    color: #888;
  }

  /* â”€â”€ ë¡œë”© â”€â”€ */
  .loading {
    text-align: center;
    padding: 80px 0;
    color: #888;
    font-size: 0.9rem;
  }
  .loading .spinner {
    display: inline-block;
    width: 30px; height: 30px;
    border: 3px solid #e0e0e0;
    border-top-color: #1a73e8;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin-bottom: 12px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* â”€â”€ ë¹ˆ ìƒíƒœ â”€â”€ */
  .empty-state {
    text-align: center;
    padding: 80px 0;
    color: #999;
  }
  .empty-state .icon { font-size: 3rem; margin-bottom: 12px; }

  /* â”€â”€ ì¹´ë“œ ê·¸ë¦¬ë“œ â”€â”€ */
  .post-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
  }
  .post-card {
    display: flex;
    flex-direction: column;
    border: 1px solid #e8e8e8;
    border-radius: 12px;
    background: #fff;
    overflow: hidden;
    cursor: pointer;
    transition: box-shadow 0.2s, transform 0.15s;
    text-decoration: none;
    color: inherit;
  }
  .post-card:hover {
    box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    transform: translateY(-2px);
  }

  .card-thumb {
    width: 100%;
    height: 180px;
    background: #f0f0f0;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .card-thumb img {
    width: 100%; height: 100%;
    object-fit: cover;
    transition: transform 0.3s;
  }
  .post-card:hover .card-thumb img { transform: scale(1.03); }
  .card-thumb .no-img {
    font-size: 3rem;
    color: #d0d0d0;
  }

  .card-body { padding: 16px; flex: 1; display: flex; flex-direction: column; }

  .card-body .post-type {
    display: inline-block;
    font-size: 0.68rem;
    font-weight: 600;
    padding: 2px 10px;
    border-radius: 10px;
    margin-bottom: 6px;
    width: fit-content;
  }
  .post-type.event { background: #e8f0fe; color: #1a73e8; }
  .post-type.visit { background: #fef7e0; color: #e8a800; }

  .card-body h3 {
    font-size: 1rem;
    font-weight: 700;
    color: #111;
    margin-bottom: 6px;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .card-body .post-excerpt {
    font-size: 0.82rem;
    color: #666;
    margin-bottom: 10px;
    flex: 1;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .card-meta {
    font-size: 0.76rem;
    color: #999;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    padding-top: 10px;
    border-top: 1px solid #f0f0f0;
  }
  .card-meta span { display: flex; align-items: center; gap: 3px; }

  /* â”€â”€ í˜ì´ì§€ë„¤ì´ì…˜ â”€â”€ */
  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 6px;
    margin-top: 32px;
  }
  .pagination button {
    min-width: 36px;
    height: 36px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background: #fff;
    color: #444;
    font-size: 0.84rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  .pagination button:hover:not(:disabled) {
    border-color: #1a73e8;
    color: #1a73e8;
  }
  .pagination button.active {
    background: #1a73e8;
    color: #fff;
    border-color: #1a73e8;
  }
  .pagination button:disabled {
    opacity: 0.4;
    cursor: default;
  }

  /* â”€â”€ í‘¸í„° â”€â”€ */
  .site-footer {
    background: #fff;
    border-top: 1px solid #e5e7eb;
    padding: 24px 20px;
    text-align: center;
    font-size: 0.78rem;
    color: #999;
    margin-top: 40px;
  }
  .site-footer a { color: #1a73e8; text-decoration: none; }
  .site-footer a:hover { text-decoration: underline; }

  /* â”€â”€ ë°˜ì‘í˜• â”€â”€ */
  @media (max-width: 700px) {
    .blog-hero { padding: 32px 16px 28px; }
    .blog-hero h1 { font-size: 1.4rem; }
    .content-wrap { padding: 16px 12px 32px; }
    .post-grid { grid-template-columns: 1fr; gap: 14px; }
    .card-thumb { height: 160px; }
    .nav-links a { padding: 5px 10px; font-size: 0.78rem; }
  }
</style>
</head>
<body>

<!-- ë„¤ë¹„ê²Œì´ì…˜ -->
<nav class="top-nav">
  <div class="nav-inner">
    <a class="nav-logo" href="https://koraia.org" target="_blank">
      <img src="https://raw.githubusercontent.com/koraia-trend/koraia-trend.github.io/refs/heads/main/koraia_circle_icon_2.png" alt="ë¡œê³ ">
      í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ
    </a>
    <div class="nav-links">
      <a href="info">AI ë‰´ìŠ¤</a>
      <a href="newsletter">ë‰´ìŠ¤ë ˆí„°</a>
      <a class="active" href="blog">ë¸”ë¡œê·¸</a>
    </div>
  </div>
</nav>

<!-- íˆì–´ë¡œ -->
<div class="blog-hero">
  <h1>íƒë°©ê¸° &amp; í–‰ì‚¬ ë¸”ë¡œê·¸</h1>
  <p>íšŒì›ì‚¬ íƒë°©, ì„¸ë¯¸ë‚˜, í–‰ì‚¬ í˜„ì¥ ê¸°ë¡ì„ ë§Œë‚˜ë³´ì„¸ìš”</p>
</div>

<!-- ì»¨í…ì¸  -->
<div class="content-wrap">
  <div class="filter-bar">
    <div class="type-filter" id="typeFilter">
      <button class="active" data-type="all">ì „ì²´</button>
      <button data-type="event">í–‰ì‚¬</button>
      <button data-type="visit">íƒë°©</button>
    </div>
    <span class="post-count" id="postCount"></span>
  </div>

  <div id="postList" class="post-grid"></div>
  <div id="pagination" class="pagination"></div>
</div>

<!-- í‘¸í„° -->
<footer class="site-footer">
  <p>&copy; 2026 <a href="https://koraia.org" target="_blank">í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ</a> Â· All rights reserved</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/supabase-config.js"></script>
<script>
(function () {
  var PAGE_SIZE = 12;
  var currentPage = 1;
  var currentType = 'all';
  var totalCount = 0;
  var client = null;

  function getClient() {
    if (client) return client;
    var url = window.SUPABASE_URL;
    var key = window.SUPABASE_ANON_KEY;
    if (!url || !key || url.indexOf('__') !== -1 || key.indexOf('__') !== -1) return null;
    client = supabase.createClient(url, key);
    return client;
  }

  function stripHtml(html) {
    if (!html) return '';
    var tmp = document.createElement('div');
    tmp.innerHTML = html;
    return (tmp.textContent || tmp.innerText || '').replace(/\s+/g, ' ').trim();
  }

  function formatDate(dateStr) {
    if (!dateStr) return '';
    var d = new Date(dateStr);
    if (isNaN(d)) return dateStr;
    return d.getFullYear() + '.' + String(d.getMonth() + 1).padStart(2, '0') + '.' + String(d.getDate()).padStart(2, '0');
  }

  function typeLabel(type) {
    if (type === 'event') return 'í–‰ì‚¬';
    if (type === 'visit') return 'íƒë°©';
    return type || '';
  }

  function fetchCount() {
    var sb = getClient();
    if (!sb) return Promise.resolve(0);
    var q = sb.from('posts').select('id', { count: 'exact', head: true })
      .eq('approval_stage', 5);
    if (currentType !== 'all') q = q.eq('type', currentType);
    return q.then(function (res) {
      return (res.error ? 0 : res.count) || 0;
    });
  }

  function fetchPosts(page) {
    var sb = getClient();
    if (!sb) return Promise.resolve([]);
    var from = (page - 1) * PAGE_SIZE;
    var to = from + PAGE_SIZE - 1;
    var q = sb.from('posts')
      .select('id, post_no, title, author_name, date, place, type, thumbnail_url, editor_html, created_at')
      .eq('approval_stage', 5)
      .order('date', { ascending: false })
      .range(from, to);
    if (currentType !== 'all') q = q.eq('type', currentType);
    return q.then(function (res) {
      return res.error ? [] : (res.data || []);
    });
  }

  function renderCard(post) {
    var excerpt = stripHtml(post.editor_html);
    if (excerpt.length > 100) excerpt = excerpt.substring(0, 100) + 'â€¦';
    var detailUrl = 'blog_post?id=' + (post.post_no || post.id);

    var thumb = '';
    if (post.thumbnail_url) {
      thumb = '<img src="' + post.thumbnail_url + '" alt="" loading="lazy">';
    } else {
      thumb = '<div class="no-img">ğŸ“„</div>';
    }

    return '<a class="post-card" href="' + detailUrl + '">' +
      '<div class="card-thumb">' + thumb + '</div>' +
      '<div class="card-body">' +
        '<span class="post-type ' + (post.type || '') + '">' + typeLabel(post.type) + '</span>' +
        '<h3>' + (post.title || 'ì œëª© ì—†ìŒ') + '</h3>' +
        (excerpt ? '<div class="post-excerpt">' + excerpt + '</div>' : '') +
        '<div class="card-meta">' +
          '<span>âœï¸ ' + (post.author_name || 'ìµëª…') + '</span>' +
          '<span>ğŸ“… ' + formatDate(post.date || post.created_at) + '</span>' +
          (post.place ? '<span>ğŸ“ ' + post.place + '</span>' : '') +
        '</div>' +
      '</div>' +
    '</a>';
  }

  function renderPagination() {
    var totalPages = Math.ceil(totalCount / PAGE_SIZE);
    if (totalPages <= 1) { document.getElementById('pagination').innerHTML = ''; return; }

    var html = '';
    html += '<button ' + (currentPage <= 1 ? 'disabled' : '') + ' data-page="' + (currentPage - 1) + '">â—€</button>';

    var start = Math.max(1, currentPage - 2);
    var end = Math.min(totalPages, start + 4);
    if (end - start < 4) start = Math.max(1, end - 4);

    for (var i = start; i <= end; i++) {
      html += '<button data-page="' + i + '"' + (i === currentPage ? ' class="active"' : '') + '>' + i + '</button>';
    }
    html += '<button ' + (currentPage >= totalPages ? 'disabled' : '') + ' data-page="' + (currentPage + 1) + '">â–¶</button>';

    var el = document.getElementById('pagination');
    el.innerHTML = html;
    el.querySelectorAll('button').forEach(function (btn) {
      btn.addEventListener('click', function () {
        var p = parseInt(this.getAttribute('data-page'));
        if (p && p !== currentPage) {
          currentPage = p;
          loadPosts();
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
      });
    });
  }

  function showLoading() {
    document.getElementById('postList').innerHTML =
      '<div class="loading"><div class="spinner"></div><br>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>';
    document.getElementById('pagination').innerHTML = '';
    document.getElementById('postCount').textContent = '';
  }

  function loadPosts() {
    showLoading();
    Promise.all([fetchCount(), fetchPosts(currentPage)]).then(function (results) {
      totalCount = results[0];
      var posts = results[1];
      var listEl = document.getElementById('postList');

      document.getElementById('postCount').textContent = 'ì´ ' + totalCount + 'ê±´';

      if (!posts.length) {
        listEl.innerHTML = '<div class="empty-state"><div class="icon">ğŸ“­</div><p>ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>';
        document.getElementById('pagination').innerHTML = '';
        return;
      }

      listEl.innerHTML = posts.map(renderCard).join('');
      renderPagination();
    });
  }

  document.getElementById('typeFilter').addEventListener('click', function (e) {
    var btn = e.target.closest('button');
    if (!btn) return;
    currentType = btn.getAttribute('data-type');
    currentPage = 1;
    this.querySelectorAll('button').forEach(function (b) { b.classList.remove('active'); });
    btn.classList.add('active');
    loadPosts();
  });

  loadPosts();
})();
</script>
</body>
</html>
