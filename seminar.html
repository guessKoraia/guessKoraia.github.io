<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>국회 AI 세미나 소식 | 한국인공지능협회</title>
    <meta name="description" content="국회에서 열리는 AI 세미나 정보를 확인하세요.">

    <meta property="og:type" content="website">
    <meta property="og:title" content="국회 AI 세미나 소식 | 한국인공지능협회">
    <meta property="og:description" content="국회에서 열리는 AI 세미나 정보를 확인하세요.">
    <meta name="twitter:title" content="국회 AI 세미나 소식 | 한국인공지능협회">
    <meta name="twitter:description" content="국회에서 열리는 AI 세미나 정보를 확인하세요.">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/seminar_og2.png">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/seminar_og2.png">
    <link href="https://framerusercontent.com/images/yHL6S80IssKYxSTQMOG4ilm6ck.png" rel="icon"
        media="(prefers-color-scheme: light)">
    <link href="https://framerusercontent.com/images/yHL6S80IssKYxSTQMOG4ilm6ck.png" rel="icon"
        media="(prefers-color-scheme: dark)">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* 세미나 전용 스타일 */
        .search-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 15px;
        }

        .clear-search-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .clear-search-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .refresh-btn {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .refresh-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        /* Articles List */
        .articles-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .article-item {
            display: grid;
            grid-template-columns: 60px 1fr 120px 80px;
            gap: 20px;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            align-items: center;
            transition: background 0.2s ease;
        }

        .article-item:hover {
            background: rgba(0, 102, 255, 0.04);
        }

        .article-item:last-child {
            border-bottom: none;
        }

        .article-number {
            font-weight: 500;
            color: var(--text-secondary);
            text-align: center;
            font-size: 1rem;
        }

        .article-content {
            min-width: 0;
        }

        .article-title {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--text-primary);
            text-decoration: none;
            display: block;
            margin-bottom: 6px;
            line-height: 1.4;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .article-title:hover {
            color: var(--accent-primary);
        }

        .article-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-align: center;
        }

        .article-link {
            text-align: center;
        }

        .read-btn {
            background: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-block;
        }

        .read-btn:hover {
            border-color: var(--accent-primary);
            color: #ffffff;
            background: var(--accent-primary);
        }

        /* Search Results */
        .search-results-info {
            background: rgba(0, 102, 255, 0.1);
            border: 1px solid var(--accent-primary);
            padding: 12px 20px;
            margin-bottom: 20px;
            border-radius: 6px;
            font-size: 1rem;
            color: var(--accent-primary);
        }

        .highlight {
            background-color: #ffeb3b;
            font-weight: 500;
            padding: 1px 2px;
        }

        /* D-Day Label Styles */
        .dday-label {
            display: inline-block;
            padding: 2px 8px;
            margin-left: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 12px;
            color: white;
            vertical-align: middle;
        }

        .dday-today {
            background-color: #e53935;
        }

        .dday-future {
            background-color: #1e88e5;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .spinner {
            border: 3px solid var(--bg-tertiary);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error and Empty States */
        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 6px;
            text-align: center;
            margin: 20px 0;
        }

        .empty-message {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .page-input-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 15px;
        }

        .page-input {
            width: 60px;
            padding: 6px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            text-align: center;
            font-size: 1rem;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .go-btn {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .go-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        /* 포스터 이미지 */
        .seminar-content-inner {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .poster-wrapper {
            position: relative;
            cursor: pointer;
            flex: 0 0 auto;
            width: 120px;
            height: 160px;
            overflow: hidden;
            border-radius: 8px;
        }

        .poster-thumb {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.18);
            transition: transform .25s ease, box-shadow .25s ease;
            background: var(--bg-tertiary);
        }

        .poster-wrapper:hover .poster-thumb {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(0,0,0,0.3);
        }

        .poster-badge {
            position: absolute;
            left: 6px;
            top: 6px;
            background: rgba(0,0,0,0.55);
            color: #fff;
            font-size: 10px;
            padding: 3px 6px;
            border-radius: 12px;
            letter-spacing: .5px;
        }

        .poster-zoom-hint {
            position: absolute;
            right: 6px;
            bottom: 6px;
            background: rgba(0,0,0,0.55);
            color: #fff;
            font-size: 10px;
            padding: 3px 6px;
            border-radius: 12px;
            opacity: 0;
            transition: opacity .25s;
        }

        .poster-wrapper:hover .poster-zoom-hint {
            opacity: 1;
        }

        /* Lightbox */
        .lightbox-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.65);
            backdrop-filter: blur(3px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 30px 40px;
        }

        .lightbox-overlay.active {
            display: flex;
        }

        .lightbox-content {
            max-width: 90vw;
            max-height: 90vh;
            position: relative;
        }

        .lightbox-img {
            max-width: 100%;
            max-height: 90vh;
            border-radius: 12px;
            box-shadow: 0 8px 28px rgba(0,0,0,0.45);
        }

        .lightbox-close {
            position: absolute;
            top: -14px;
            right: -14px;
            background: #ff4757;
            color: #fff;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 22px;
            cursor: pointer;
            box-shadow: 0 4px 14px rgba(0,0,0,.45);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .lightbox-close:hover {
            background: #e03131;
        }

        @media (max-width: 640px) {
            .poster-wrapper {
                width: 100px;
                height: 133px;
            }
        }

        @media (max-width: 768px) {
            .article-item {
                grid-template-columns: 1fr 80px;
                gap: 15px;
            }
            
            .article-number,
            .article-link {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .article-item {
                grid-template-columns: 1fr;
                gap: 10px;
                padding: 15px;
            }
            
            .article-date {
                text-align: left;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <a href="/" class="site-logo">
                (사)한국인공지능협회
            </a>
            <nav class="nav-menu">
                <a href="/index" class="nav-link">전문자료실</a>
                <a href="/info" class="nav-link">AI 뉴스</a>
                <a href="/biz" class="nav-link">사업공고</a>
                <a href="/seminar" class="nav-link active">국회 AI 세미나</a>
                <a href="/newsletter" class="nav-link external-link">AI 뉴스레터</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="hero-section">
            <h1 class="hero-title" id="section-title">국회 AI 세미나 소식</h1>
            <p class="hero-subtitle">국회에서 열리는 AI 세미나 정보를 검색하고 확인할 수 있습니다.</p>

            <div class="search-wrapper">
                <input type="text" id="search-input" class="search-input" placeholder="세미나명, 주최, 장소 등으로 검색...">
                <button id="searchBtn" class="search-btn"><i class="fas fa-search"></i></button>
            </div>

            <div class="search-controls">
                <button class="clear-search-btn" onclick="clearSearch()" style="display: none;" id="clear-search-btn">검색 초기화</button>
                <!-- <button class="refresh-btn" onclick="loadSeminars()"><i class="fas fa-sync-alt"></i> 새로고침</button> -->
            </div>
        </section>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-label">Total Seminars</span>
                <span class="stat-value" id="total-count">-</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">New Today</span>
                <span class="stat-value" id="today-count">-</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Total Pages</span>
                <span class="stat-value" id="total-pages">-</span>
            </div>
        </div>

        <div id="search-results-info" class="search-results-info" style="display: none;"></div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>세미나 정보를 불러오는 중...</p>
        </div>

        <div id="error" class="error-message" style="display: none;">
            <h3>오류가 발생했습니다</h3>
            <p id="error-text"></p>
        </div>

        <div id="seminar-container" class="articles-container" style="display: none;">
            <div id="seminars"></div>
        </div>

        <div id="pagination" class="pagination" style="display: none;"></div>
    </main>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>(사)한국인공지능협회</h3>
                    <p>인공지능 관련 최신 정보와 전문 자료를 제공합니다.</p>
                    <p style="margin-top: 12px; color: var(--text-tertiary); font-size: 0.85rem;">
                        국회 AI 세미나 정보를 실시간으로 확인하실 수 있습니다.
                    </p>
                </div>
                <div class="footer-section">
                    <h3>주요 메뉴</h3>
                    <p><a href="/index">전문자료실</a></p>
                    <p><a href="/info">AI 뉴스</a></p>
                    <p><a href="/biz">사업공고</a></p>
                    <p><a href="/seminar">국회 AI 세미나</a></p>
                    <p><a href="/newsletter">AI 뉴스레터</a></p>
                </div>
                <div class="footer-section">
                    <h3>연락처</h3>
                    <p>이메일: info@koraia.org</p>
                    <p>전화: 02-713-4800</p>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="footer-copyright">
                    © 2025 (사)한국인공지능협회. All rights reserved.
                </div>
                <div class="footer-links">
                    <!-- <a hr -->
                </div>
            </div>
        </div>
    </footer>

    <button class="scroll-top" id="scrollTop" title="Move to Top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <div class="lightbox-overlay" id="lightbox" aria-modal="true" role="dialog" aria-label="포스터 확대 보기">
        <div class="lightbox-content">
            <button class="lightbox-close" id="lightbox-close" aria-label="닫기">×</button>
            <img src="" alt="세미나 포스터" id="lightbox-img" class="lightbox-img" loading="lazy" />
        </div>
    </div>

    <script>
        // Supabase 설정
        const SUPABASE_URL = 'https://kydkwdwtsqsjxasirxoi.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_8s2AtTlUWOaLtiOvdsH7jQ_t7gVjUCM';
        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // 전역 변수
        let currentPage = 1;
        const itemsPerPage = 20;
        let totalItems = 0;
        let totalPages = 0;
        let currentSearchQuery = '';
        let isSearchMode = false;
        
        // ===== [NEW] D-Day Label Function =====
        /**
         * Calculates and returns a D-Day HTML label for a given date.
         * @param {string} dateString - The event date from the database.
         * @returns {string} - HTML string for the D-Day label, or an empty string.
         */
        function getDDayLabel(dateString) {
            if (!dateString) return '';

            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize today to the start of the day

            const eventDate = new Date(dateString);
            eventDate.setHours(0, 0, 0, 0); // Normalize event date to the start of the day

            // Don't show label for past events
            if (eventDate < today) {
                return '';
            }

            const diffTime = eventDate.getTime() - today.getTime();
            const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 0) {
                return '<span class="dday-label dday-today">D-DAY</span>';
            } else {
                return `<span class="dday-label dday-future">D-${diffDays}</span>`;
            }
        }
        // ===== End of New Function =====

        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function highlightSearchTerm(text, searchTerm) {
            if (!searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        async function loadSeminars(page = 1) {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            const seminarsEl = document.getElementById('seminars');
            const seminarContainer = document.getElementById('seminar-container');
            const paginationEl = document.getElementById('pagination');

            currentPage = page;

            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';
            seminarContainer.style.display = 'none';
            paginationEl.style.display = 'none';
            seminarsEl.innerHTML = '';

            try {
                let query = supabaseClient.from('ampos_seminar').select('*', { count: 'exact' });
                // 검색 모드인 경우 필터 추가
                if (isSearchMode && currentSearchQuery) {
                    query = query.or(`seminar_name.ilike.%${currentSearchQuery}%,organizer.ilike.%${currentSearchQuery}%,location.ilike.%${currentSearchQuery}%`);
                }

                // 전체 개수 조회
                const { count: totalCount } = await query.select('*', { count: 'exact', head: true });
                totalItems = totalCount || 0;
                totalPages = Math.ceil(totalItems / itemsPerPage);

                // 페이지 범위 계산
                const startIndex = (page - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage - 1;

                // 데이터 조회
                let dataQuery = supabaseClient.from('ampos_seminar').select('*');
                if (isSearchMode && currentSearchQuery) {
                    dataQuery = dataQuery.or(`seminar_name.ilike.%${currentSearchQuery}%,organizer.ilike.%${currentSearchQuery}%,location.ilike.%${currentSearchQuery}%`);
                }

                const { data: seminars, error } = await dataQuery
                    .order('event_date', { ascending: false })
                    .range(startIndex, endIndex);

                if (error) throw error;

                await updateStats();
                loadingEl.style.display = 'none';

                updateSearchResultsInfo();

                if (!seminars || seminars.length === 0) {
                    let message = '등록된 세미나가 없습니다.';
                    if (isSearchMode) {
                        message = `"${currentSearchQuery}" 검색 결과가 없습니다.`;
                    }
                    seminarsEl.innerHTML = `<div class="empty-message">${message}</div>`;
                    return;
                }

                seminarContainer.style.display = 'block';
                seminarsEl.innerHTML = seminars.map((seminar, index) => {
                    const itemNumber = totalItems - startIndex - index;
                    const highlightedName = highlightSearchTerm(seminar.seminar_name || '', currentSearchQuery);
                    const highlightedOrganizer = highlightSearchTerm(seminar.organizer || '', currentSearchQuery);
                    const highlightedLocation = highlightSearchTerm(seminar.location || '', currentSearchQuery);
                    const posterHTML = seminar.poster_url ? `
                        <div class="poster-wrapper" data-full="${seminar.poster_url}" tabindex="0" aria-label="포스터 확대 보기">
                            <img src="${seminar.poster_url}" alt="포스터" class="poster-thumb" loading="lazy" />
                            <span class="poster-badge">포스터</span>
                            <span class="poster-zoom-hint">클릭 확대</span>
                        </div>` : '';
                    
                    // ===== [MODIFIED] Get D-Day label =====
                    const dDayLabel = getDDayLabel(seminar.event_date);
                    
                    return `
                        <div class="article-item">
                            <div class="article-number">${itemNumber}</div>
                            <div class="article-content">
                                <div class="seminar-content-inner">
                                    ${posterHTML}
                                    <div>
                                        <div class="article-title">${highlightedName}</div>
                                        <div style="font-size:0.9em;color:#555;margin-top:4px;line-height:1.5;">
                                            <div>주최: ${highlightedOrganizer || '-'}</div>
                                            <div>장소: ${highlightedLocation || '-'}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="article-date">
                                ${formatDate(seminar.event_date)}
                                ${dDayLabel}
                            </div>
                            <div class="article-link">
                                ${seminar.material_link ? `<a href="${seminar.material_link}" target="_blank" class="read-btn">자료보기</a>` : ''}
                            </div>
                        </div>
                    `;
                }).join('');

                renderPagination();

            } catch (error) {
                console.error('Error:', error);
                loadingEl.style.display = 'none';
                errorEl.style.display = 'block';
                document.getElementById('error-text').textContent = error.message;
            }
        }

        function performSearch() {
            const searchInput = document.getElementById('search-input');
            const searchQuery = searchInput.value.trim();
            if (searchQuery.length === 0) {
                clearSearch();
                return;
            }
            currentSearchQuery = searchQuery;
            isSearchMode = true;
            currentPage = 1;
            document.getElementById('clear-search-btn').style.display = 'inline-block';
            document.getElementById('section-title').textContent = '검색 결과';
            loadSeminars(1);
        }

        function clearSearch() {
            document.getElementById('search-input').value = '';
            currentSearchQuery = '';
            isSearchMode = false;
            currentPage = 1;
            document.getElementById('clear-search-btn').style.display = 'none';
            document.getElementById('section-title').textContent = '국회 AI 세미나 소식';
            document.getElementById('search-results-info').style.display = 'none';
            loadSeminars(1);
        }

        function updateSearchResultsInfo() {
            const searchResultsInfo = document.getElementById('search-results-info');
            if (isSearchMode && currentSearchQuery) {
                searchResultsInfo.style.display = 'block';
                searchResultsInfo.innerHTML = `"<strong>${currentSearchQuery}</strong>" 검색 결과: ${totalItems}개 세미나`;
            } else {
                searchResultsInfo.style.display = 'none';
            }
        }

        function renderPagination() {
            const paginationEl = document.getElementById('pagination');
            if (totalPages <= 1) {
                paginationEl.style.display = 'none';
                return;
            }
            paginationEl.style.display = 'flex';
            
            // 모바일 여부 확인
            const isMobile = window.innerWidth <= 768;
            
            let paginationHTML = '';
            paginationHTML += `<button class="page-btn" onclick="goToPage(1)" ${currentPage === 1 ? 'disabled' : ''}>⏮️</button>`;
            paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>◀️</button>`;
            
            if (isMobile) {
                // 모바일: 현재 페이지 중심으로 좌우 1개씩만 표시
                let startPage = Math.max(1, currentPage - 1);
                let endPage = Math.min(totalPages, currentPage + 1);
                
                // 첫 페이지 표시
                if (startPage > 1) {
                    paginationHTML += `<button class="page-btn ${1 === currentPage ? 'active' : ''}" onclick="goToPage(1)">1</button>`;
                    if (startPage > 2) {
                        paginationHTML += `<button class="page-btn" onclick="goToPage(${startPage - 1})" title="이전">...</button>`;
                    }
                }
                
                // 현재 페이지 주변 표시
                for (let i = startPage; i <= endPage; i++) {
                    paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                }
                
                // 마지막 페이지 표시
                if (endPage < totalPages) {
                    if (endPage < totalPages - 1) {
                        paginationHTML += `<button class="page-btn" onclick="goToPage(${endPage + 1})" title="다음">...</button>`;
                    }
                    paginationHTML += `<button class="page-btn ${totalPages === currentPage ? 'active' : ''}" onclick="goToPage(${totalPages})">${totalPages}</button>`;
                }
            } else {
                // 데스크톱: 10개씩 구간별로 페이지 번호 표시
                const pageGroup = Math.ceil(currentPage / 10);
                const startPage = (pageGroup - 1) * 10 + 1;
                const endPage = Math.min(pageGroup * 10, totalPages);
                
                if (startPage > 1) {
                    paginationHTML += `<button class="page-btn" onclick="goToPage(${startPage - 1})" title="이전 10페이지">...</button>`;
                }
                for (let i = startPage; i <= endPage; i++) {
                    paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                }
                if (endPage < totalPages) {
                    paginationHTML += `<button class="page-btn" onclick="goToPage(${endPage + 1})" title="다음 10페이지">...</button>`;
                }
            }
            
            paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>▶️</button>`;
            paginationHTML += `<button class="page-btn" onclick="goToPage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''}>⏭️</button>`;
            paginationHTML += `
                <div class="page-input-group">
                    <input type="number" class="page-input" id="page-input" placeholder="${currentPage}" min="1" max="${totalPages}">
                    <button class="go-btn" onclick="goToInputPage()">이동</button>
                </div>
            `;
            paginationEl.innerHTML = paginationHTML;
        }

        function goToPage(page) {
            if (page >= 1 && page <= totalPages && page !== currentPage) {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
                loadSeminars(page);
            }
        }

        function goToInputPage() {
            const input = document.getElementById('page-input');
            const page = parseInt(input.value);
            if (page >= 1 && page <= totalPages) {
                goToPage(page);
                input.value = '';
            } else {
                alert(`1부터 ${totalPages} 사이의 페이지 번호를 입력해주세요.`);
            }
        }

        async function updateStats() {
            try {
                document.getElementById('total-count').textContent = totalItems;
                document.getElementById('total-pages').textContent = totalPages;
                const today = new Date().toISOString().split('T')[0];
                const { count: todayCount } = await supabaseClient
                    .from('ampos_seminar')
                    .select('*', { count: 'exact', head: true })
                    .gte('created_at', today);
                document.getElementById('today-count').textContent = todayCount || 0;
            } catch (error) {
                console.error('Stats error:', error);
                document.getElementById('total-count').textContent = totalItems;
                document.getElementById('today-count').textContent = '-';
                document.getElementById('total-pages').textContent = totalPages;
            }
        }

        // 스크롤 버튼 표시/숨김 처리
        const scrollTopBtn = document.getElementById('scrollTop');
        window.addEventListener('scroll', function () {
            if (window.pageYOffset > 300) {
                scrollTopBtn.classList.add('visible');
            } else {
                scrollTopBtn.classList.remove('visible');
            }
        });

        // 스크롤 상단 버튼 클릭 이벤트
        scrollTopBtn.addEventListener('click', function () {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // 이벤트 리스너
        document.getElementById('search-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
        document.getElementById('searchBtn').addEventListener('click', function() {
            performSearch();
        });
        document.addEventListener('keydown', function(e) {
            if (e.target.id === 'page-input' && e.key === 'Enter') {
                goToInputPage();
            }
        });
        // Lightbox 기능
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxClose = document.getElementById('lightbox-close');
        function openLightbox(src){
            lightboxImg.src = src;
            lightbox.classList.add('active');
            document.body.style.overflow='hidden';
        }
        function closeLightbox(){
            lightbox.classList.remove('active');
            lightboxImg.src = '';
            document.body.style.overflow='';
        }
        document.addEventListener('click', e => {
            const wrapper = e.target.closest('.poster-wrapper');
            if (wrapper) {
                openLightbox(wrapper.getAttribute('data-full'));
            } else if (e.target === lightbox) {
                closeLightbox();
            }
        });
        document.addEventListener('keydown', e => { if(e.key==='Escape' && lightbox.classList.contains('active')) closeLightbox(); });
        lightboxClose.addEventListener('click', closeLightbox);

        // 화면 크기 변경 시 페이지네이션 재렌더링
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(function() {
                if (totalPages > 1) {
                    renderPagination();
                }
            }, 250);
        });

        // 초기 로드
        window.addEventListener('load', () => loadSeminars(1));
        // 자동 새로고침 (5분마다)
        setInterval(() => loadSeminars(currentPage), 5 * 60 * 1000);
    </script>
</body>

</html>


