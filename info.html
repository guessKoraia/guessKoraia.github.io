<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¸ê³µì§€ëŠ¥ ì†Œì‹ ëª¨ìŒ | í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ</title>
    <meta name="description" content="í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ ì¸ê³µì§€ëŠ¥ ì†Œì‹ ëª¨ìŒ | ì¸ê³µì§€ëŠ¥ ê´€ë ¨ ìµœì‹  ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ì¸ê³µì§€ëŠ¥ ì†Œì‹ ëª¨ìŒ | í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ">
    <meta property="og:description" content="ì¸ê³µì§€ëŠ¥ ê´€ë ¨ ìµœì‹  ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.">
    <meta name="twitter:title" content="ì¸ê³µì§€ëŠ¥ ì†Œì‹ ëª¨ìŒ | í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ">
    <meta name="twitter:description" content="ì¸ê³µì§€ëŠ¥ ê´€ë ¨ ìµœì‹  ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/report_2.png">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/report_2.png">
    <link href="https://framerusercontent.com/images/yHL6S80IssKYxSTQMOG4ilm6ck.png" rel="icon"
        media="(prefers-color-scheme: light)">
    <link href="https://framerusercontent.com/images/yHL6S80IssKYxSTQMOG4ilm6ck.png" rel="icon"
        media="(prefers-color-scheme: dark)">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            color: #333;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: #ffffff;
            border-bottom: 3px solid #1a73e8;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-top {
            padding: 15px 0;
            border-bottom: 1px solid #e5e5e5;
        }

        .site-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1a73e8;
            text-decoration: none;
            letter-spacing: -1px;
        }

        .site-subtitle {
            color: #666;
            font-size: 0.9rem;
            font-weight: 400;
            margin-top: 4px;
        }

        .header-nav {
            padding: 12px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-menu {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-link {
            font-size: 1rem;
            color: #666;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .nav-link:hover {
            color: #1a73e8;
        }

        .nav-link.active {
            color: #1a73e8;
            font-weight: 600;
        }

        .nav-stats {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .stat-item {
            font-size: 0.85rem;
            color: #666;
        }

        .stat-number {
            font-weight: 600;
            color: #1a73e8;
        }

        /* Search Section */
        .search-section {
            background: #f8f9fa;
            border-bottom: 1px solid #e5e5e5;
            padding: 20px 0;
        }

        .search-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-box {
            position: relative;
            flex: 1;
            min-width: 300px;
        }

        .search-input {
            width: 100%;
            padding: 12px 45px 12px 20px;
            border: 2px solid #e5e5e5;
            border-radius: 25px;
            font-size: 1rem;
            transition: border-color 0.2s ease;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: #1a73e8;
        }

        .search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: #1a73e8;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s ease;
        }

        .search-btn:hover {
            background: #1557b0;
        }

        .search-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .clear-search-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .clear-search-btn:hover {
            background: #545b62;
        }

        .filter-btn {
            border: 2px solid #17a2b8;
            background: white;
            color: #17a2b8;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .filter-btn:hover {
            background: #f8f9fa;
            transform: translateY(-1px);
        }

        .filter-btn.active {
            background: #17a2b8;
            color: white;
            border-color: #17a2b8;
            box-shadow: 0 2px 8px rgba(23, 162, 184, 0.3);
        }

        .filter-btn.active:hover {
            background: #138496;
            border-color: #138496;
        }

        .report-filter-btn {
            border: 2px solid #6f42c1;
            background: white;
            color: #6f42c1;
        }

        .report-filter-btn:hover {
            background: #f8f9fa;
        }

        .report-filter-btn.active {
            background: #6f42c1;
            color: white;
            border-color: #6f42c1;
            box-shadow: 0 2px 8px rgba(111, 66, 193, 0.3);
        }

        .report-filter-btn.active:hover {
            background: #5a32a3;
            border-color: #5a32a3;
        }

        .refresh-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .refresh-btn:hover {
            background: #1e7e34;
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }

        .page-info {
            color: #666;
            font-size: 0.9rem;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #1a73e8;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Articles List */
        .articles-container {
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            overflow: hidden;
        }

        .article-item {
            display: grid;
            grid-template-columns: 60px 1fr 120px 80px;
            gap: 20px;
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
            align-items: center;
            transition: background-color 0.2s ease;
        }

        .article-item:hover {
            background-color: #f8f9fa;
        }

        .article-item:last-child {
            border-bottom: none;
        }

        .article-number {
            font-weight: 500;
            color: #666;
            text-align: center;
            font-size: 0.9rem;
        }

        .article-content {
            min-width: 0;
        }

        .article-title {
            font-size: 1.05rem;
            font-weight: 500;
            color: #333;
            text-decoration: none;
            display: block;
            margin-bottom: 6px;
            line-height: 1.4;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .article-title:hover {
            color: #1a73e8;
        }


        .article-date {
            font-size: 0.85rem;
            color: #888;
            text-align: center;
        }

        .article-link {
            text-align: center;
        }

        .read-btn {
            background: #1a73e8;
            color: white;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            transition: background 0.2s ease;
            display: inline-block;
        }

        .read-btn:hover {
            background: #1557b0;
        }

        /* Search Results */
        .search-results-info {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            padding: 12px 20px;
            margin-bottom: 20px;
            border-radius: 6px;
            font-size: 0.9rem;
            color: #1565c0;
        }

        .highlight {
            background-color: #ffeb3b;
            font-weight: 500;
            padding: 1px 2px;
        }

        .event-label {
            background: #dc3545;
            color: white;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 8px;
            display: inline-block;
        }

        .report-label {
            background: #6f42c1;
            color: white;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 8px;
            display: inline-block;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .page-btn {
            background: white;
            border: 1px solid #dee2e6;
            color: #495057;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 36px;
        }

        .page-btn:hover:not(:disabled) {
            background: #f8f9fa;
            border-color: #adb5bd;
        }

        .page-btn:disabled {
            background: #f8f9fa;
            color: #6c757d;
            cursor: not-allowed;
            border-color: #dee2e6;
        }

        .page-btn.active {
            background: #1a73e8;
            border-color: #1a73e8;
            color: white;
        }

        .page-input-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 15px;
        }

        .page-input {
            width: 60px;
            padding: 6px 8px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            text-align: center;
            font-size: 0.9rem;
        }

        .go-btn {
            background: #ffc107;
            color: #212529;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .go-btn:hover {
            background: #e0a800;
        }

        /* Error and Empty States */
        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 6px;
            text-align: center;
            margin: 20px 0;
        }

        .empty-message {
            text-align: center;
            padding: 60px 20px;
            color: #666;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e5e5e5;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header-nav {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .nav-menu {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }

            .nav-stats {
                gap: 15px;
                flex-wrap: wrap;
            }
            
            .search-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: auto;
            }
            
            .search-controls {
                justify-content: center;
            }
            
            .article-item {
                grid-template-columns: 1fr 80px;
                gap: 15px;
            }
            
            .article-number,
            .article-link {
                display: none;
            }
            
            .content-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .pagination {
                gap: 4px;
            }
            
            .page-btn {
                padding: 6px 8px;
                font-size: 0.8rem;
                min-width: 32px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            .header-container {
                padding: 0 15px;
            }
            
            .site-title {
                font-size: 1.8rem;
            }
            
            .article-item {
                grid-template-columns: 1fr;
                gap: 10px;
                padding: 15px;
            }
            
            .article-date {
                text-align: left;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <div class="header-top">
                <a href="/" class="site-title">(ì‚¬)í•œêµ­ì¸ê³µì§€ëŠ¥í˜‘íšŒ</a>
                <div class="site-subtitle">ì¸ê³µì§€ëŠ¥ ë‰´ìŠ¤ì™€ ì •ë³´ë¥¼ í•œëˆˆì— ì‚´í´ë³´ì„¸ìš”.</div>
            </div>
            <nav class="header-nav">
                <div class="nav-menu">
                    <a href="/index" class="nav-link">ì „ë¬¸ìë£Œì‹¤</a>
                    <a href="/info" class="nav-link active">AI ë‰´ìŠ¤</a>
                    <a href="/biz" class="nav-link">ì‚¬ì—…ê³µê³ </a>
                    <a href="/seminar" class="nav-link">êµ­íšŒ AI ì„¸ë¯¸ë‚˜</a>
                    <a href="/newsletter" class="nav-link">AI ë‰´ìŠ¤ë ˆí„°</a>
                </div>
                <div class="nav-stats">
                    <div class="stat-item">
                        ì´ <span class="stat-number" id="total-count">-</span>ê°œ ê¸°ì‚¬
                    </div>
                    <div class="stat-item">
                        ì˜¤ëŠ˜ <span class="stat-number" id="today-count">-</span>ê°œ ì¶”ê°€
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="total-pages">-</span> í˜ì´ì§€
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <section class="search-section">
        <div class="search-container">
            <div class="search-box">
                <input type="text" class="search-input" id="search-input" placeholder="ê¸°ì‚¬ ì œëª©ì„ ê²€ìƒ‰í•˜ì„¸ìš”...">
                <button class="search-btn" onclick="performSearch()">ğŸ”</button>
            </div>
                         <div class="search-controls">
                <button class="clear-search-btn" onclick="clearSearch()" style="display: none;" id="clear-search-btn">ê²€ìƒ‰ ì´ˆê¸°í™”</button>
                <button class="filter-btn" onclick="toggleEventFilter()" id="event-filter-btn">ğŸ“… í–‰ì‚¬</button>
                <button class="filter-btn report-filter-btn" onclick="toggleReportFilter()" id="report-filter-btn">ğŸ“Š ë³´ê³ ì„œ</button>
                <button class="refresh-btn" onclick="loadArticles()">ìƒˆë¡œê³ ì¹¨</button>
            </div>
        </div>
    </section>

    <main class="container">
        <div class="content-header">
            <h2 class="section-title" id="section-title">ìµœì‹  AI ë‰´ìŠ¤</h2>
            <div class="page-info" id="page-info">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        </div>

        <div id="search-results-info" class="search-results-info" style="display: none;"></div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>AI ë‰´ìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>

        <div id="error" class="error-message" style="display: none;">
            <h3>ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</h3>
            <p id="error-text"></p>
        </div>

        <div id="articles-container" class="articles-container" style="display: none;">
            <div id="articles"></div>
        </div>

        <div id="pagination" class="pagination" style="display: none;"></div>
    </main>

    <script>
        // Supabase ì„¤ì •
        const SUPABASE_URL = 'https://kydkwdwtsqsjxasirxoi.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_8s2AtTlUWOaLtiOvdsH7jQ_t7gVjUCM';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

                 // ì „ì—­ ë³€ìˆ˜
        let currentPage = 1;
        const itemsPerPage = 50;
        let totalItems = 0;
        let totalPages = 0;
        let currentSearchQuery = '';
        let isSearchMode = false;
        let isEventMode = false;
        let isReportMode = false;

        function formatDateKST(dateString) {
    const date = new Date(dateString);
    const now = new Date();

    // KST(ë¡œì»¬ ì‹œê°„) ê¸°ì¤€ìœ¼ë¡œ ì‹œê°„ ë¶€ë¶„ì„ ì œì™¸í•œ ë‚ ì§œ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    // ì´ë ‡ê²Œ í•˜ë©´ ë‚ ì§œ(YYYY-MM-DD)ë§Œì„ ê¸°ì¤€ìœ¼ë¡œ ì •í™•í•˜ê²Œ ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    const dateOnly = new Date(date.getFullYear(), date.getMonth(), date.getDate());
    const nowOnly = new Date(now.getFullYear(), now.getMonth(), now.getDate());

    // ë‘ ë‚ ì§œ ê°„ì˜ ì°¨ì´ë¥¼ ì¼(day) ë‹¨ìœ„ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤.
    const diff = Math.floor((nowOnly - dateOnly) / (1000 * 60 * 60 * 24));

    if (diff === 0) return 'ì˜¤ëŠ˜';
    if (diff === 1) return 'ì–´ì œ';
    if (diff > 0 && diff < 7) return `${diff}ì¼ ì „`;
    if (diff < 0) {
        const futureDiff = Math.abs(diff);
        if (futureDiff === 1) return 'ë‚´ì¼';
        return `${futureDiff}ì¼ í›„`;
    }

    // (ì„ íƒ ì‚¬í•­) 7ì¼ ì´ìƒ ì°¨ì´ ë‚˜ëŠ” ê²½ìš°, ë‚ ì§œë¥¼ ì§ì ‘ í‘œì‹œ
    if (diff >= 7) {
        return `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
    }

    // ë‚ ì§œ í¬ë§·íŒ… ë¶€ë¶„ì€ ì›ë˜ëŒ€ë¡œ ë¡œì»¬ ê¸°ì¤€ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ ìì—°ìŠ¤ëŸ¬ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    return date.toLocaleDateString('ko-KR', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
    });
}

        function truncateTitle(title, maxLength = 120) {
            if (title.length <= maxLength) return title;
            return title.substring(0, maxLength) + '...';
        }

        function highlightSearchTerm(text, searchTerm) {
            if (!searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        function isEventArticle(url) {
            return url.includes('onoffmix') || url.includes('event-us');
        }

        function isReportArticle(url) {
            return url.includes('ksp.etri.re.kr') || 
                   url.includes('iitp.kr') || 
                   url.includes('ettrends.etri.re.kr') || 
                   url.includes('spri.kr') || 
                   url.includes('nia.or.kr');
        }

        function toggleEventFilter() {
            isEventMode = !isEventMode;
            
            // ë³´ê³ ì„œ ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ë¹„í™œì„±í™”
            if (isEventMode && isReportMode) {
                isReportMode = false;
                document.getElementById('report-filter-btn').classList.remove('active');
            }
            
            currentPage = 1;
            
            const eventBtn = document.getElementById('event-filter-btn');
            const sectionTitle = document.getElementById('section-title');
            
            if (isEventMode) {
                eventBtn.classList.add('active');
                sectionTitle.textContent = 'í–‰ì‚¬ ì •ë³´';
            } else {
                eventBtn.classList.remove('active');
                sectionTitle.textContent = getSectionTitle();
            }
            
            loadArticles(1);
        }

        function toggleReportFilter() {
            isReportMode = !isReportMode;
            
            // í–‰ì‚¬ ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ë¹„í™œì„±í™”
            if (isReportMode && isEventMode) {
                isEventMode = false;
                document.getElementById('event-filter-btn').classList.remove('active');
            }
            
            currentPage = 1;
            
            const reportBtn = document.getElementById('report-filter-btn');
            const sectionTitle = document.getElementById('section-title');
            
            if (isReportMode) {
                reportBtn.classList.add('active');
                sectionTitle.textContent = 'ë³´ê³ ì„œ ì •ë³´';
            } else {
                reportBtn.classList.remove('active');
                sectionTitle.textContent = getSectionTitle();
            }
            
            loadArticles(1);
        }

        function getSectionTitle() {
            if (isSearchMode) return 'ê²€ìƒ‰ ê²°ê³¼';
            if (isEventMode) return 'í–‰ì‚¬ ì •ë³´';
            if (isReportMode) return 'ë³´ê³ ì„œ ì •ë³´';
            return 'ìµœì‹  AI ë‰´ìŠ¤';
        }

        async function loadArticles(page = 1) {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            const articlesEl = document.getElementById('articles');
            const articlesContainer = document.getElementById('articles-container');
            const paginationEl = document.getElementById('pagination');
            
            currentPage = page;
            
            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';
            articlesContainer.style.display = 'none';
            paginationEl.style.display = 'none';
            articlesEl.innerHTML = '';

            try {
                let query = supabase.from('ai_info').select('*', { count: 'exact' });
                
                // ê²€ìƒ‰ ëª¨ë“œì¸ ê²½ìš° í•„í„° ì¶”ê°€
                if (isSearchMode && currentSearchQuery) {
                    query = query.ilike('title', `%${currentSearchQuery}%`);
                }
                
                // í–‰ì‚¬ í•„í„°ì¸ ê²½ìš° í•„í„° ì¶”ê°€
                if (isEventMode) {
                    query = query.or('url.ilike.%onoffmix%,url.ilike.%event-us%');
                }
                
                // ë³´ê³ ì„œ í•„í„°ì¸ ê²½ìš° í•„í„° ì¶”ê°€
                if (isReportMode) {
                    query = query.or('url.ilike.%ksp.etri.re.kr%,url.ilike.%iitp.kr%,url.ilike.%ettrends.etri.re.kr%,url.ilike.%spri.kr%,url.ilike.%nia.or.kr%');
                }
                
                // ì „ì²´ ê°œìˆ˜ ì¡°íšŒ
                const { count: totalCount } = await query.select('*', { count: 'exact', head: true });
                
                totalItems = totalCount || 0;
                totalPages = Math.ceil(totalItems / itemsPerPage);

                // í˜ì´ì§€ ë²”ìœ„ ê³„ì‚°
                const startIndex = (page - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage - 1;

                // ë°ì´í„° ì¡°íšŒ
                let dataQuery = supabase.from('ai_info').select('*');
                
                if (isSearchMode && currentSearchQuery) {
                    dataQuery = dataQuery.ilike('title', `%${currentSearchQuery}%`);
                }
                
                if (isEventMode) {
                    dataQuery = dataQuery.or('url.ilike.%onoffmix%,url.ilike.%event-us%');
                }
                
                if (isReportMode) {
                    dataQuery = dataQuery.or('url.ilike.%ksp.etri.re.kr%,url.ilike.%iitp.kr%,url.ilike.%ettrends.etri.re.kr%,url.ilike.%spri.kr%,url.ilike.%nia.or.kr%');
                }
                
                const { data: ai_info, error } = await dataQuery
                    .order('created_at', { ascending: false })
                    .range(startIndex, endIndex);

                if (error) throw error;

                await updateStats();
                loadingEl.style.display = 'none';

                // ê²€ìƒ‰ ê²°ê³¼ ì •ë³´ ì—…ë°ì´íŠ¸
                updateSearchResultsInfo();

                if (!ai_info || ai_info.length === 0) {
                    let message = 'ë“±ë¡ëœ ê¸°ì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.';
                    if (isSearchMode) {
                        message = `"${currentSearchQuery}" ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.`;
                    } else if (isEventMode) {
                        message = 'ë“±ë¡ëœ í–‰ì‚¬ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.';
                    } else if (isReportMode) {
                        message = 'ë“±ë¡ëœ ë³´ê³ ì„œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.';
                    }
                    articlesEl.innerHTML = `<div class="empty-message">${message}</div>`;
                    return;
                }

                articlesContainer.style.display = 'block';
                
                articlesEl.innerHTML = ai_info.map((article, index) => {
                    // í•„í„°ë§ëœ ê²°ê³¼ì—ì„œì˜ ìˆœë²ˆ ê³„ì‚° (ìµœì‹ ìˆœ ì •ë ¬ì´ë¯€ë¡œ í° ë²ˆí˜¸ë¶€í„°)
                    // ì˜ˆ: í–‰ì‚¬ 50ê°œ â†’ 1í˜ì´ì§€: 50,49,48...41 / 2í˜ì´ì§€: 40,39,38...31
                    const itemNumber = totalItems - startIndex - index;
                    const highlightedTitle = highlightSearchTerm(article.title, currentSearchQuery);
                    const truncatedTitle = truncateTitle(highlightedTitle, 120);
                    const eventLabel = isEventArticle(article.url) ? '<span class="event-label">í–‰ì‚¬</span>' : '';
                    const reportLabel = isReportArticle(article.url) ? '<span class="report-label">ë³´ê³ ì„œ</span>' : '';
                    const labels = eventLabel + reportLabel;
                    
                    return `
                        <div class="article-item">
                            <div class="article-number">${itemNumber}</div>
                            <div class="article-content">
                                <a href="${article.url}" target="_blank" class="article-title">${labels} ${truncatedTitle}</a>
                                
                            </div>
                            <div class="article-date">${formatDateKST(article.created_at)}</div>
                            <div class="article-link">
                                <a href="${article.url}" target="_blank" class="read-btn">ì½ê¸°</a>
                            </div>
                        </div>
                    `;
                }).join('');

                renderPagination();
                updatePageInfo();

            } catch (error) {
                console.error('Error:', error);
                loadingEl.style.display = 'none';
                errorEl.style.display = 'block';
                document.getElementById('error-text').textContent = error.message;
            }
        }

        function performSearch() {
            const searchInput = document.getElementById('search-input');
            const searchQuery = searchInput.value.trim();
            
            if (searchQuery.length === 0) {
                clearSearch();
                return;
            }
            
            currentSearchQuery = searchQuery;
            isSearchMode = true;
            currentPage = 1;
            
            document.getElementById('clear-search-btn').style.display = 'inline-block';
            document.getElementById('section-title').textContent = 'ê²€ìƒ‰ ê²°ê³¼';
            
            loadArticles(1);
        }

        function clearSearch() {
            document.getElementById('search-input').value = '';
            currentSearchQuery = '';
            isSearchMode = false;
            currentPage = 1;
            
            document.getElementById('clear-search-btn').style.display = 'none';
            
            // í˜„ì¬ í™œì„±í™”ëœ í•„í„°ì— ë”°ë¼ ì œëª© ì„¤ì •
            document.getElementById('section-title').textContent = getSectionTitle();
            
            document.getElementById('search-results-info').style.display = 'none';
            
            loadArticles(1);
        }

        function updateSearchResultsInfo() {
            const searchResultsInfo = document.getElementById('search-results-info');
            
            if (isSearchMode && currentSearchQuery) {
                searchResultsInfo.style.display = 'block';
                let filterText = '';
                if (isEventMode) filterText = ' (í–‰ì‚¬ë§Œ)';
                else if (isReportMode) filterText = ' (ë³´ê³ ì„œë§Œ)';
                searchResultsInfo.innerHTML = `"<strong>${currentSearchQuery}</strong>" ê²€ìƒ‰ ê²°ê³¼${filterText}: ${totalItems}ê°œ ê¸°ì‚¬`;
            } else if (isEventMode) {
                searchResultsInfo.style.display = 'block';
                searchResultsInfo.innerHTML = `í–‰ì‚¬ í•„í„° ê²°ê³¼: ${totalItems}ê°œ ê¸°ì‚¬`;
            } else if (isReportMode) {
                searchResultsInfo.style.display = 'block';
                searchResultsInfo.innerHTML = `ë³´ê³ ì„œ í•„í„° ê²°ê³¼: ${totalItems}ê°œ ê¸°ì‚¬`;
            } else {
                searchResultsInfo.style.display = 'none';
            }
        }

        function renderPagination() {
            const paginationEl = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                paginationEl.style.display = 'none';
                return;
            }

            paginationEl.style.display = 'flex';

            let paginationHTML = '';

            paginationHTML += `<button class="page-btn" onclick="goToPage(1)" ${currentPage === 1 ? 'disabled' : ''}>â®ï¸</button>`;
            paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>â—€ï¸</button>`;

            // 10ê°œì”© êµ¬ê°„ë³„ë¡œ í˜ì´ì§€ ë²ˆí˜¸ í‘œì‹œ
            const pageGroup = Math.ceil(currentPage / 10);
            const startPage = (pageGroup - 1) * 10 + 1;
            const endPage = Math.min(pageGroup * 10, totalPages);

            // ì´ì „ 10ê°œ êµ¬ê°„ìœ¼ë¡œ ì´ë™ ë²„íŠ¼
            if (startPage > 1) {
                paginationHTML += `<button class="page-btn" onclick="goToPage(${startPage - 1})" title="ì´ì „ 10í˜ì´ì§€">...</button>`;
            }

            // í˜ì´ì§€ ë²ˆí˜¸ë“¤ (ìµœëŒ€ 10ê°œ)
            for (let i = startPage; i <= endPage; i++) {
                paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
            }

            // ë‹¤ìŒ 10ê°œ êµ¬ê°„ìœ¼ë¡œ ì´ë™ ë²„íŠ¼
            if (endPage < totalPages) {
                paginationHTML += `<button class="page-btn" onclick="goToPage(${endPage + 1})" title="ë‹¤ìŒ 10í˜ì´ì§€">...</button>`;
            }

            paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>â–¶ï¸</button>`;
            paginationHTML += `<button class="page-btn" onclick="goToPage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''}>â­ï¸</button>`;

            paginationHTML += `
                <div class="page-input-group">
                    <input type="number" class="page-input" id="page-input" placeholder="${currentPage}" min="1" max="${totalPages}">
                    <button class="go-btn" onclick="goToInputPage()">ì´ë™</button>
                </div>
            `;

            paginationEl.innerHTML = paginationHTML;
        }

        function goToPage(page) {
            if (page >= 1 && page <= totalPages && page !== currentPage) {
                loadArticles(page);
            }
        }

        function goToInputPage() {
            const input = document.getElementById('page-input');
            const page = parseInt(input.value);
            if (page >= 1 && page <= totalPages) {
                goToPage(page);
                input.value = '';
            } else {
                alert(`1ë¶€í„° ${totalPages} ì‚¬ì´ì˜ í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
            }
        }

        function updatePageInfo() {
            const pageInfoEl = document.getElementById('page-info');
            const startItem = (currentPage - 1) * itemsPerPage + 1;
            const endItem = Math.min(currentPage * itemsPerPage, totalItems);
            
            pageInfoEl.textContent = `${startItem}-${endItem} / ì´ ${totalItems}ê°œ`;
        }

        async function updateStats() {
            try {
                document.getElementById('total-count').textContent = totalItems;
                document.getElementById('total-pages').textContent = totalPages;

                const today = new Date().toISOString().split('T')[0];
                const { count: todayCount } = await supabase
                    .from('ai_info')
                    .select('*', { count: 'exact', head: true })
                    .gte('created_at', today);

                document.getElementById('today-count').textContent = todayCount || 0;

            } catch (error) {
                console.error('Stats error:', error);
                document.getElementById('total-count').textContent = totalItems;
                document.getElementById('today-count').textContent = '-';
                document.getElementById('total-pages').textContent = totalPages;
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('search-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.target.id === 'page-input' && e.key === 'Enter') {
                goToInputPage();
            }
        });

        // ì´ˆê¸° ë¡œë“œ
        window.addEventListener('load', () => loadArticles(1));

        // ìë™ ìƒˆë¡œê³ ì¹¨ (5ë¶„ë§ˆë‹¤)
        setInterval(() => loadArticles(currentPage), 5 * 60 * 1000);
    </script>
</body>

</html> 




