<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인공지능 소식 모음 | 한국인공지능협회</title>
    <meta name="description" content="한국인공지능협회 인공지능 소식 모음 | 인공지능 관련 최신 정보를 확인하세요.">
    <meta property="og:type" content="website">
    <meta property="og:title" content="인공지능 소식 모음 | 한국인공지능협회">
    <meta property="og:description" content="인공지능 관련 최신 정보를 확인하세요.">
    <meta name="twitter:title" content="인공지능 소식 모음 | 한국인공지능협회">
    <meta name="twitter:description" content="인공지능 관련 최신 정보를 확인하세요.">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/report_222.png">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/report_222.png">
    <link href="https://framerusercontent.com/images/yHL6S80IssKYxSTQMOG4ilm6ck.png" rel="icon"
        media="(prefers-color-scheme: light)">
    <link href="https://framerusercontent.com/images/yHL6S80IssKYxSTQMOG4ilm6ck.png" rel="icon"
        media="(prefers-color-scheme: dark)">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* AI 뉴스 전용 스타일 */
        .search-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .clear-search-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .clear-search-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .filter-btn {
            border: 2px solid #17a2b8;
            background: white;
            color: #17a2b8;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .filter-btn:hover {
            background: #f8f9fa;
            transform: translateY(-1px);
        }

        .filter-btn.active {
            background: #17a2b8;
            color: white;
            border-color: #17a2b8;
            box-shadow: 0 2px 8px rgba(23, 162, 184, 0.3);
        }

        .filter-btn.active:hover {
            background: #138496;
            border-color: #138496;
        }

        .report-filter-btn {
            border: 2px solid #6f42c1;
            background: white;
            color: #6f42c1;
        }

        .report-filter-btn:hover {
            background: #f8f9fa;
        }

        .report-filter-btn.active {
            background: #6f42c1;
            color: white;
            border-color: #6f42c1;
            box-shadow: 0 2px 8px rgba(111, 66, 193, 0.3);
        }

        .report-filter-btn.active:hover {
            background: #5a32a3;
            border-color: #5a32a3;
        }

        .refresh-btn {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .refresh-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        /* Articles List */
        .articles-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .article-header {
            display: grid;
            grid-template-columns: 60px 1fr 120px 80px;
            gap: 20px;
            padding: 16px 24px;
            background: var(--bg-tertiary);
            border-bottom: 2px solid var(--border-color);
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }

        .article-header-item {
            text-align: center;
        }

        .article-header-item:first-child {
            text-align: center;
        }

        .article-header-item:nth-child(2) {
            text-align: left;
        }

        .article-item {
            display: grid;
            grid-template-columns: 60px 1fr 120px 80px;
            gap: 20px;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            align-items: center;
            transition: background 0.2s ease;
        }

        .article-item:nth-child(even) {
            background: rgba(0, 0, 0, 0.02);
        }

        .article-item:hover {
            background: rgba(0, 102, 255, 0.04) !important;
        }

        .article-item:last-child {
            border-bottom: none;
        }

        .article-number {
            font-weight: 500;
            color: var(--text-secondary);
            text-align: center;
            font-size: 0.9rem;
        }

        .article-content {
            min-width: 0;
        }

        .article-title {
            font-size: 1.05rem;
            font-weight: 500;
            color: var(--text-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            line-height: 1.4;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .article-title:hover {
            color: var(--accent-primary);
        }

        .fav {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
            border-radius: 2px;
        }

        .article-date {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
        }

        .article-link {
            text-align: center;
        }

        /* 기본 '읽기' 버튼 (안 읽은 상태: 연한 파스텔톤) */
        .read-btn {
            background: #e7f1ff; /* 아주 연한 파스텔 파랑 */
            color: #0066ff;
            border: 1px solid #cce0ff;
            text-decoration: none;
            padding: 6px 16px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            transition: all 0.2s ease;
            display: inline-block;
        }
        
        .read-btn:hover {
            background: #0066ff;
            color: #ffffff;
            border-color: #0066ff;
        }
        
        /* 읽은 상태의 버튼 (현재 액센트 컬러로 채움) */
        .article-item.visited .read-btn {
            background: #f1f3f5 !important; /* 연한 회색 배경 */
            color: #adb5bd !important;      /* 흐린 회색 글씨 */
            border: 1px solid #dee2e6 !important;
            cursor: default;
        }
        
        /* 읽은 줄 전체 배경색 (더 연하게 조정) */
        .article-item.visited {
            background-color: #fcfcfc !important;
        }

        /* Search Results */
        .search-results-info {
            background: rgba(0, 102, 255, 0.1);
            border: 1px solid var(--accent-primary);
            padding: 12px 20px;
            margin-bottom: 20px;
            border-radius: 6px;
            font-size: 0.9rem;
            color: var(--accent-primary);
        }

        .highlight {
            background-color: #ffeb3b;
            font-weight: 500;
            padding: 1px 2px;
        }

        .event-label {
            background: #dc3545;
            color: white;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 8px;
            display: inline-block;
        }

        .report-label {
            background: #6f42c1;
            color: white;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 8px;
            display: inline-block;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .spinner {
            border: 3px solid var(--bg-tertiary);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error and Empty States */
        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 6px;
            text-align: center;
            margin: 20px 0;
        }

        .empty-message {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .page-input-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 15px;
        }

        .page-input {
            width: 60px;
            padding: 6px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            text-align: center;
            font-size: 0.9rem;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .go-btn {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .go-btn:hover {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        @media (max-width: 768px) {
            .article-header {
                grid-template-columns: 1fr 80px;
                gap: 15px;
            }

            .article-header-item:first-child,
            .article-header-item:last-child {
                display: none;
            }
            
            .article-item {
                grid-template-columns: 1fr 80px;
                gap: 15px;
            }
            
            .article-number,
            .article-link {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .article-header {
                grid-template-columns: 1fr;
                gap: 10px;
                padding: 12px 15px;
            }

            .article-header-item:not(:first-child) {
                display: none;
            }
            
            .article-item {
                grid-template-columns: 1fr;
                gap: 10px;
                padding: 15px;
            }
            
            .article-date {
                text-align: left;
                font-size: 0.8rem;
            }
        }

        
        .article-item.visited .article-title {
            color: #adb5bd !important;
        }
        
        .read-badge {
            background: #f8f9fa;
            color: #adb5bd;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 8px;
            display: inline-block;
            border: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <a href="/" class="site-logo">
                (사)한국인공지능협회
            </a>
            <nav class="nav-menu">
                <a href="/index" class="nav-link">전문자료실</a>
                <a href="/info" class="nav-link active">AI 뉴스</a>
                <a href="/biz" class="nav-link">사업공고</a>
                <a href="/seminar" class="nav-link">국회 AI 세미나</a>
                <a href="/newsletter" class="nav-link external-link">AI 뉴스레터</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="hero-section">
            <h1 class="hero-title" id="section-title">실시간 AI 뉴스</h1>
            <p class="hero-subtitle">인공지능 관련 최신 뉴스와 정보를 검색하고 확인할 수 있습니다.</p>

            <div class="search-wrapper">
                <input type="text" id="search-input" class="search-input" placeholder="기사 제목을 검색하세요...">
                <button id="searchBtn" class="search-btn"><i class="fas fa-search"></i></button>
            </div>

            <div class="search-controls">
                <button class="clear-search-btn" onclick="clearSearch()" style="display: none;" id="clear-search-btn">검색 초기화</button>
                <button class="filter-btn" onclick="toggleEventFilter()" id="event-filter-btn"><i class="fas fa-calendar-alt"></i> 행사</button>
                <button class="filter-btn report-filter-btn" onclick="toggleReportFilter()" id="report-filter-btn"><i class="fas fa-file-alt"></i> 보고서</button>
                <button class="refresh-btn" onclick="loadArticles()"><i class="fas fa-sync-alt"></i> 새로고침</button>
                <button class="refresh-btn" onclick="localStorage.removeItem('read_articles'); location.reload();">
    <i class="fas fa-trash"></i> 기록 삭제
</button>
            </div>
        </section>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-label">Total Articles</span>
                <span class="stat-value" id="total-count">-</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">New Today</span>
                <span class="stat-value" id="today-count">-</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Total Pages</span>
                <span class="stat-value" id="total-pages">-</span>
            </div>
        </div>

        <div id="search-results-info" class="search-results-info" style="display: none;"></div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>AI 뉴스를 불러오는 중...</p>
        </div>

        <div id="error" class="error-message" style="display: none;">
            <h3>오류가 발생했습니다</h3>
            <p id="error-text"></p>
        </div>

        <div id="articles-container" class="articles-container" style="display: none;">
            <div class="article-header">
                <div class="article-header-item">번호</div>
                <div class="article-header-item">제목</div>
                <div class="article-header-item">날짜</div>
                <div class="article-header-item">링크</div>
            </div>
            <div id="articles"></div>
        </div>

        <div id="pagination" class="pagination" style="display: none;"></div>
    </main>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3><img src="https://raw.githubusercontent.com/guessKoraia/guessKoraia.github.io/refs/heads/main/koraia_main_popup/KORAIA_Logo_(%EC%82%AC)%ED%95%9C%EA%B5%AD%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5%ED%98%91%ED%9A%8C_%EA%B8%B0%EB%B3%B8_color_%EA%B0%80%EB%A1%9C@4x.png"  style="width: 50%" alt=""></h3>
                    <p>인공지능 관련 최신 정보와 전문 자료를 제공합니다.</p>
                    <p style="margin-top: 12px; color: var(--text-tertiary); font-size: 0.85rem;">
                        AI 뉴스와 정보를 실시간으로 확인하실 수 있습니다.
                    </p>
                </div>
                <div class="footer-section">
                    <h3>주요 메뉴</h3>
                    <p><a href="/index">전문자료실</a></p>
                    <p><a href="/info">AI 뉴스</a></p>
                    <p><a href="/biz">사업공고</a></p>
                    <p><a href="/seminar">국회 AI 세미나</a></p>
                    <p><a href="/newsletter">AI 뉴스레터</a></p>
                </div>
                <div class="footer-section">
                    <h3>연락처</h3>
                    <p>이메일: info@koraia.org</p>
                    <p>전화: 02-713-4800</p>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="footer-copyright">
                    © 2025 (사)한국인공지능협회. All rights reserved.
                </div>
                <div class="footer-links">
                    <!-- <a href="#">개인정보처리방침</a> -->
                </div>
            </div>
        </div>
    </footer>

    <button class="scroll-top" id="scrollTop" title="Move to Top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>

        // 읽은 기사 ID 목록 가져오기
        function getReadArticles() {
            const read = localStorage.getItem('read_articles');
            return read ? JSON.parse(read) : [];
        }
        
        // 읽은 기사로 저장하기 + 즉시 화면 반영
        function markAsRead(id) {
            let read = getReadArticles();
            const stringId = String(id);
            
            if (!read.includes(stringId)) {
                read.push(stringId);
                localStorage.setItem('read_articles', JSON.stringify(read));
            }
        
            // 화면 즉시 업데이트
            const itemEl = document.getElementById(`item-${id}`);
            if (itemEl) {
                // 1. 전체 줄에 visited 클래스 추가 (글자색, 버튼색 변경 트리거)
                itemEl.classList.add('visited'); 
                
                // 2. 제목 끝에 [읽음] 라벨 추가
                const titleEl = itemEl.querySelector('.article-title');
                if (titleEl && !titleEl.querySelector('.read-badge')) {
                    const badge = document.createElement('span');
                    badge.className = 'read-badge';
                    badge.innerText = '읽음';
                    titleEl.appendChild(badge); 
                }
            }
        }
        
        // Supabase 설정
        const SUPABASE_URL = 'https://kydkwdwtsqsjxasirxoi.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_8s2AtTlUWOaLtiOvdsH7jQ_t7gVjUCM';

        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

                 // 전역 변수
        let currentPage = 1;
        const itemsPerPage = 50;
        let totalItems = 0;
        let totalPages = 0;
        let currentSearchQuery = '';
        let isSearchMode = false;
        let isEventMode = false;
        let isReportMode = false;

        // URL에서 도메인 추출하여 파비콘 URL 생성
        function getFaviconUrl(url) {
            try {
                const urlObj = new URL(url);
                const domain = urlObj.hostname;
                return `https://www.google.com/s2/favicons?domain=${domain}&sz=16`;
            } catch (e) {
                return `https://www.google.com/s2/favicons?domain=${url}&sz=16`;
            }
        }

        function formatDateKST(dateString) {
            // 1. dateString에 '+09'가 있으므로, new Date()는 이를 자동으로 인식하여 로컬 시간으로 변환합니다.
            const date = new Date(dateString);
            const now = new Date();
        
            // 2. '날짜'만 비교하기 위해 연, 월, 일을 추출하여 새로운 객체 생성
            // (시, 분, 초의 차이 때문에 '오늘'이 '어제'로 인식되는 것을 방지)
            const dateOnly = new Date(date.getFullYear(), date.getMonth(), date.getDate());
            const nowOnly = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        
            // 3. 두 날짜의 차이를 밀리초 단위로 구한 뒤 '일(day)' 단위로 환산
            const diffTime = nowOnly - dateOnly;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        
            if (diffDays === 0) return '오늘';
            if (diffDays === 1) return '어제';
            if (diffDays > 1 && diffDays < 7) return `${diffDays}일 전`;
            
            if (diffDays < 0) {
                const futureDiff = Math.abs(diffDays);
                if (futureDiff === 1) return '내일';
                return `${futureDiff}일 후`;
            }
        
            // 4. 7일 이상 차이 나면 날짜 그대로 표시
            return `${date.getFullYear()}년 ${date.getMonth() + 1}월 ${date.getDate()}일`;
        }

        function truncateTitle(title, maxLength = 120) {
            if (title.length <= maxLength) return title;
            return title.substring(0, maxLength) + '...';
        }

        function highlightSearchTerm(text, searchTerm) {
            if (!searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        function isEventArticle(url) {
            return url.includes('onoffmix') || url.includes('event-us');
        }

        function isReportArticle(url) {
            return url.includes('ksp.etri.re.kr') || 
                   url.includes('iitp.kr') || 
                   url.includes('ettrends.etri.re.kr') || 
                   url.includes('spri.kr') || 
                   url.includes('nia.or.kr');
        }

        function toggleEventFilter() {
            isEventMode = !isEventMode;
            
            // 보고서 모드가 활성화되어 있으면 비활성화
            if (isEventMode && isReportMode) {
                isReportMode = false;
                document.getElementById('report-filter-btn').classList.remove('active');
            }
            
            currentPage = 1;
            
            const eventBtn = document.getElementById('event-filter-btn');
            const sectionTitle = document.getElementById('section-title');
            
            if (isEventMode) {
                eventBtn.classList.add('active');
                sectionTitle.textContent = '행사 정보';
            } else {
                eventBtn.classList.remove('active');
                sectionTitle.textContent = getSectionTitle();
            }
            
            loadArticles(1);
        }

        function toggleReportFilter() {
            isReportMode = !isReportMode;
            
            // 행사 모드가 활성화되어 있으면 비활성화
            if (isReportMode && isEventMode) {
                isEventMode = false;
                document.getElementById('event-filter-btn').classList.remove('active');
            }
            
            currentPage = 1;
            
            const reportBtn = document.getElementById('report-filter-btn');
            const sectionTitle = document.getElementById('section-title');
            
            if (isReportMode) {
                reportBtn.classList.add('active');
                sectionTitle.textContent = '보고서 정보';
            } else {
                reportBtn.classList.remove('active');
                sectionTitle.textContent = getSectionTitle();
            }
            
            loadArticles(1);
        }

        function getSectionTitle() {
            if (isSearchMode) return '검색 결과';
            if (isEventMode) return '행사 정보';
            if (isReportMode) return '보고서 정보';
            return '최신 AI 뉴스';
        }

        async function loadArticles(page = 1) {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            const articlesEl = document.getElementById('articles');
            const articlesContainer = document.getElementById('articles-container');
            const paginationEl = document.getElementById('pagination');
            
            currentPage = page;
            
            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';
            articlesContainer.style.display = 'none';
            paginationEl.style.display = 'none';
            articlesEl.innerHTML = '';

            try {
                let query = supabaseClient.from('ai_info').select('*', { count: 'exact' });
                
                // 검색 모드인 경우 필터 추가
                if (isSearchMode && currentSearchQuery) {
                    query = query.ilike('title', `%${currentSearchQuery}%`);
                }
                
                // 행사 필터인 경우 필터 추가
                if (isEventMode) {
                    query = query.or('url.ilike.%onoffmix%,url.ilike.%event-us%');
                }
                
                // 보고서 필터인 경우 필터 추가
                if (isReportMode) {
                    query = query.or('url.ilike.%ksp.etri.re.kr%,url.ilike.%iitp.kr%,url.ilike.%ettrends.etri.re.kr%,url.ilike.%spri.kr%,url.ilike.%nia.or.kr%');
                }
                
                // 전체 개수 조회
                const { count: totalCount } = await query.select('*', { count: 'exact', head: true });
                
                totalItems = totalCount || 0;
                totalPages = Math.ceil(totalItems / itemsPerPage);

                // 페이지 범위 계산
                const startIndex = (page - 1) * itemsPerPage;
                const endIndex = startIndex + itemsPerPage - 1;

                // 데이터 조회
                let dataQuery = supabaseClient.from('ai_info').select('*');
                
                if (isSearchMode && currentSearchQuery) {
                    dataQuery = dataQuery.ilike('title', `%${currentSearchQuery}%`);
                }
                
                if (isEventMode) {
                    dataQuery = dataQuery.or('url.ilike.%onoffmix%,url.ilike.%event-us%');
                }
                
                if (isReportMode) {
                    dataQuery = dataQuery.or('url.ilike.%ksp.etri.re.kr%,url.ilike.%iitp.kr%,url.ilike.%ettrends.etri.re.kr%,url.ilike.%spri.kr%,url.ilike.%nia.or.kr%');
                }
                
                const { data: ai_info, error } = await dataQuery
                    .order('created_at', { ascending: false })
                    .range(startIndex, endIndex);

                if (error) throw error;

                await updateStats();
                loadingEl.style.display = 'none';

                // 검색 결과 정보 업데이트
                updateSearchResultsInfo();

                if (!ai_info || ai_info.length === 0) {
                    let message = '등록된 기사가 없습니다.';
                    if (isSearchMode) {
                        message = `"${currentSearchQuery}" 검색 결과가 없습니다.`;
                    } else if (isEventMode) {
                        message = '등록된 행사 정보가 없습니다.';
                    } else if (isReportMode) {
                        message = '등록된 보고서 정보가 없습니다.';
                    }
                    articlesEl.innerHTML = `<div class="empty-message">${message}</div>`;
                    return;
                }

                articlesContainer.style.display = 'block';
                
                // loadArticles 함수의 ai_info.map 내부 수정
                articlesEl.innerHTML = ai_info.map((article, index) => {
                    const itemNumber = totalItems - startIndex - index;
                    const highlightedTitle = highlightSearchTerm(article.title, currentSearchQuery);
                    const truncatedTitle = truncateTitle(highlightedTitle, 120);
                    
                    // 읽음 여부 확인 (문자열로 변환하여 비교)
                    const readList = getReadArticles().map(String);
                    const isRead = readList.includes(String(article.id)); 
                    
                    const readBadge = isRead ? '<span class="read-badge">읽음</span>' : '';
                    const visitedClass = isRead ? 'visited' : '';
                
                    const eventLabel = isEventArticle(article.url) ? '<span class="event-label">행사</span>' : '';
                    const reportLabel = isReportArticle(article.url) ? '<span class="report-label">보고서</span>' : '';
                    const labels = eventLabel + reportLabel;
                    const faviconUrl = getFaviconUrl(article.url);
                    
                    return `
                        <div class="article-item ${visitedClass}" id="item-${article.id}">
                            <div class="article-number">${itemNumber}</div>
                            <div class="article-content">
                                <a href="${article.url}" target="_blank" class="article-title" onclick="markAsRead('${article.id}')">
                                    <img class="fav" src="${faviconUrl}" alt="" onerror="this.style.display='none'">
                                    ${labels} ${truncatedTitle} ${readBadge} </a>
                            </div>
                            <div class="article-date">${formatDateKST(article.created_at)}</div>
                            <div class="article-link">
                                <a href="${article.url}" target="_blank" class="read-btn" onclick="markAsRead('${article.id}')">읽기</a>
                            </div>
                        </div>
                    `;
                }).join('');

                renderPagination();

            } catch (error) {
                console.error('Error:', error);
                loadingEl.style.display = 'none';
                errorEl.style.display = 'block';
                document.getElementById('error-text').textContent = error.message;
            }
        }

        function performSearch() {
            const searchInput = document.getElementById('search-input');
            const searchQuery = searchInput.value.trim();
            
            if (searchQuery.length === 0) {
                clearSearch();
                return;
            }
            
            currentSearchQuery = searchQuery;
            isSearchMode = true;
            currentPage = 1;
            
            document.getElementById('clear-search-btn').style.display = 'inline-block';
            document.getElementById('section-title').textContent = '검색 결과';
            
            loadArticles(1);
        }

        function clearSearch() {
            document.getElementById('search-input').value = '';
            currentSearchQuery = '';
            isSearchMode = false;
            currentPage = 1;
            
            document.getElementById('clear-search-btn').style.display = 'none';
            
            // 현재 활성화된 필터에 따라 제목 설정
            document.getElementById('section-title').textContent = getSectionTitle();
            
            document.getElementById('search-results-info').style.display = 'none';
            
            loadArticles(1);
        }

        function updateSearchResultsInfo() {
            const searchResultsInfo = document.getElementById('search-results-info');
            
            if (isSearchMode && currentSearchQuery) {
                searchResultsInfo.style.display = 'block';
                let filterText = '';
                if (isEventMode) filterText = ' (행사만)';
                else if (isReportMode) filterText = ' (보고서만)';
                searchResultsInfo.innerHTML = `"<strong>${currentSearchQuery}</strong>" 검색 결과${filterText}: ${totalItems}개 기사`;
            } else if (isEventMode) {
                searchResultsInfo.style.display = 'block';
                searchResultsInfo.innerHTML = `행사 필터 결과: ${totalItems}개 기사`;
            } else if (isReportMode) {
                searchResultsInfo.style.display = 'block';
                searchResultsInfo.innerHTML = `보고서 필터 결과: ${totalItems}개 기사`;
            } else {
                searchResultsInfo.style.display = 'none';
            }
        }

        function renderPagination() {
            const paginationEl = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                paginationEl.style.display = 'none';
                return;
            }

            paginationEl.style.display = 'flex';

            // 모바일 여부 확인
            const isMobile = window.innerWidth <= 768;
            const maxVisiblePages = isMobile ? 3 : 10;

            let paginationHTML = '';

            paginationHTML += `<button class="page-btn" onclick="goToPage(1)" ${currentPage === 1 ? 'disabled' : ''}>⏮️</button>`;
            paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>◀️</button>`;

            if (isMobile) {
                // 모바일: 현재 페이지 중심으로 좌우 1개씩만 표시
                let startPage = Math.max(1, currentPage - 1);
                let endPage = Math.min(totalPages, currentPage + 1);
                
                // 첫 페이지 표시
                if (startPage > 1) {
                    paginationHTML += `<button class="page-btn ${1 === currentPage ? 'active' : ''}" onclick="goToPage(1)">1</button>`;
                    if (startPage > 2) {
                        paginationHTML += `<button class="page-btn" onclick="goToPage(${startPage - 1})" title="이전">...</button>`;
                    }
                }
                
                // 현재 페이지 주변 표시
                for (let i = startPage; i <= endPage; i++) {
                    paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                }
                
                // 마지막 페이지 표시
                if (endPage < totalPages) {
                    if (endPage < totalPages - 1) {
                        paginationHTML += `<button class="page-btn" onclick="goToPage(${endPage + 1})" title="다음">...</button>`;
                    }
                    paginationHTML += `<button class="page-btn ${totalPages === currentPage ? 'active' : ''}" onclick="goToPage(${totalPages})">${totalPages}</button>`;
                }
            } else {
                // 데스크톱: 10개씩 구간별로 페이지 번호 표시
                const pageGroup = Math.ceil(currentPage / 10);
                const startPage = (pageGroup - 1) * 10 + 1;
                const endPage = Math.min(pageGroup * 10, totalPages);

                // 이전 10개 구간으로 이동 버튼
                if (startPage > 1) {
                    paginationHTML += `<button class="page-btn" onclick="goToPage(${startPage - 1})" title="이전 10페이지">...</button>`;
                }

                // 페이지 번호들 (최대 10개)
                for (let i = startPage; i <= endPage; i++) {
                    paginationHTML += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
                }

                // 다음 10개 구간으로 이동 버튼
                if (endPage < totalPages) {
                    paginationHTML += `<button class="page-btn" onclick="goToPage(${endPage + 1})" title="다음 10페이지">...</button>`;
                }
            }

            paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>▶️</button>`;
            paginationHTML += `<button class="page-btn" onclick="goToPage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''}>⏭️</button>`;

            paginationHTML += `
                <div class="page-input-group">
                    <input type="number" class="page-input" id="page-input" placeholder="${currentPage}" min="1" max="${totalPages}">
                    <button class="go-btn" onclick="goToInputPage()">이동</button>
                </div>
            `;

            paginationEl.innerHTML = paginationHTML;
        }

        function goToPage(page) {
            if (page >= 1 && page <= totalPages && page !== currentPage) {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
                loadArticles(page);
            }
        }

        function goToInputPage() {
            const input = document.getElementById('page-input');
            const page = parseInt(input.value);
            if (page >= 1 && page <= totalPages) {
                goToPage(page);
                input.value = '';
            } else {
                alert(`1부터 ${totalPages} 사이의 페이지 번호를 입력해주세요.`);
            }
        }

        async function updateStats() {
            try {
                document.getElementById('total-count').textContent = totalItems;
                document.getElementById('total-pages').textContent = totalPages;
        
                // 한국 시간 기준 '오늘 00:00:00' 구하기
                const now = new Date();
                const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                
                const { count: todayCount } = await supabaseClient
                    .from('ai_info')
                    .select('*', { count: 'exact', head: true })
                    .gte('created_at', todayStart.toISOString()); // ISO 형식으로 쿼리
        
                document.getElementById('today-count').textContent = todayCount || 0;

            } catch (error) {
                console.error('Stats error:', error);
                document.getElementById('total-count').textContent = totalItems;
                document.getElementById('today-count').textContent = '-';
                document.getElementById('total-pages').textContent = totalPages;
            }
        }

        // 스크롤 버튼 표시/숨김 처리
        const scrollTopBtn = document.getElementById('scrollTop');
        window.addEventListener('scroll', function () {
            if (window.pageYOffset > 300) {
                scrollTopBtn.classList.add('visible');
            } else {
                scrollTopBtn.classList.remove('visible');
            }
        });

        // 스크롤 상단 버튼 클릭 이벤트
        scrollTopBtn.addEventListener('click', function () {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // 이벤트 리스너
        document.getElementById('search-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
        document.getElementById('searchBtn').addEventListener('click', function() {
            performSearch();
        });
        document.addEventListener('keydown', function(e) {
            if (e.target.id === 'page-input' && e.key === 'Enter') {
                goToInputPage();
            }
        });

        // 화면 크기 변경 시 페이지네이션 재렌더링
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(function() {
                if (totalPages > 1) {
                    renderPagination();
                }
            }, 250);
        });

        // 초기 로드
        window.addEventListener('load', () => loadArticles(1));
    </script>
</body>

</html> 






